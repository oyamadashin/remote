#データ等下準備
data<-read.csv("BAZAAR.csv",header=TRUE)
data$garm_use
t.test(data$garm_memory2,data$garm_memory1)
#対応のあるt検定（同じサンプルの前後の差についての検定なので）
t.test(data$garm_memory2,data$garm_memory1,paired=T)
t.test(data$garm_memory2,data$garm_memory1,paired=T)
#対応のあるt検定（同じサンプルの前後の差についての検定なので）
t.test(data$garm_coldhot2,data$garm_coldhod1,paired=T)
data$garm_coldhot2
data$garm_coldhod1
#対応のあるt検定（同じサンプルの前後の差についての検定なので）
t.test(data$garm_coldhot2,data$garm_coldhot1,paired=T)
t.test(data$garm_fashion2,data$garm_fashion1,paired=T)
t.test(data$garm_presentation2,data$garm_presentation1,paired=T)
t.test(data$garm_body2,data$garm_body1,paired=T)
#データ等下準備
data<-read.csv("BAZAAR.csv",header=TRUE)
t.test(data$garm_transform2,data$garm_transform1,paired=T)
t.test(data$garm_custom2,data$garm_custom1,paired=T)
t.test(data$garm_unity2,data$garm_unity1,paired=T)
t.test(data$garm_memory2,data$garm_memory1,paired=T)#1%水準有意
data$garm_why1
ribrary(tidyverse)
library(tidyverse)
data$garm_why1 %>%
table()
a<-data$garm_why1 %>%
table()
a
rbind(a,b)
b<-data$garm_why2 %>%
table()
rbind(a,b)
before<-data$garm_why1 %>%
table()
after<-data$garm_why2 %>%
table()
rbind(before,after)
data$garm_why2
mx<-rbind(before,after)
mx
mx(,1)
mx[,1]
mx[1,1]
mx[1,]
mx[2,]
mx[,1]
mx[,2]
mx[,3]
mx[,4]
mx[,5]
mx[,6]
t(mx)
before<-data$garm_why1 %>%
table(na.rm = TRUE)
data$garm_why1
matrix(0,nrow=2,byrow=3)
matrix(0),nrow=2,byrow=T)
matrix((0),nrow=2,byrow=T)
matrix(rep(0,10),nrow=2,byrow=T)
r_names<-c("資源保全","思い出","節約","希少性","他人のオプション","わからない","そう思わない")
matrix(rep(0,14),nrow=2,byrow=T)
my_names<-c("資源保全","思い出","節約","希少性","他人のオプション","わからない","そう思わない")
colnames(a)
names(a)
a<-matrix(rep(0,14),nrow=2,byrow=T)
rownames(a)
colnames(a)
colnames(a)<-my_names
colnames(a)
a
after
after<-data$garm_why2 %>%
table()
after
a<-matrix(c(data$garm_why1,data$garm_why2),nrow=2,byrow=T)
a
a[1,]
table(a)
mynames_r<-c("before",after)
rownames(a)<-mynames_r
a<-matrix(c(data$garm_why1,data$garm_why2),nrow=2,byrow=T)
mynames_r<-c("before",after)
rownames(a)<-mynames_r
mynames_r<-c("before","after")
rownames(a)<-mynames_r
a
a %>%
summary()
a %>%
table()
a = select(.data = data, 1,3)
a
a = select(.data = data, 17,32)
a
a %>%
table()
mynames_r<-c("資源保全","思い出","節約","希少性","他人のオプション","わからない","そう思わない")
rownames(a)<-mynames_r
#データ等下準備
data<-read.csv("BAZAAR.csv",header=TRUE)
library(tidyverse)
a = select(.data = data, 17,32)
my_names<-c("資源保全","思い出","節約","希少性","他人のオプション","そう思わない")
a %>%
table()
a %>%
table()
mynames_r<-c("資源保全","思い出","節約","希少性","他人のオプション","そう思わない")
#「わからない」という回答者はいないのでラベルはつくらない。
rownames(a)<-mynames_r
rownames(a)
mynames_c<-c("資源保全","思い出","節約","希少性","他人のオプション","そう思わない")
colnames(a)<-mynames_c
colnames(a)<-mynames_r
mynames_c<-c("資源保全","思い出","節約","希少性","他人のオプション","そう思わない")
colnames(a)
a_table<-a %>%
table()
colnames(a_table)
table(a$garm_why1,a$garm_why2)
a_table<-table(a$garm_why1,a$garm_why2)
colnames(a_table)
a$garm_why1
a$garm_why2
a$garm_why1
table(a$garm_why1)
table(a$garm_why1) %>%
t()
n <- 150
q0101 <- sample(c(0, 1), size=n, replace=T, prob=c(.30, .70))
q0102 <- sample(c(0, 1), size=n, replace=T, prob=c(.60, .40))
q0103 <- sample(c(0, 1), size=n, replace=T, prob=c(.40, .60))
q0104 <- sample(c(0, 1), size=n, replace=T, prob=c(.80, .20))
d01 <- data.frame(q0101, q0102, q0103, q0104)
d01
nYES <- apply(d01, MARGIN=2, FUN=sum)
nYES
a = select(.data = data, 17,32)
a
a %>%
table()
atable<-a %>%
table()
colnames(atable)
atable
names(atable)
rownames(atable)
table(a$garm_why1)
table(a$garm_why1) %>%
edit()
a<-table(data$garm_why1)
b<-table(data$garm_why2)
colnames(a)
colnames(b)
a<-table(data$garm_why1)
b<-table(data$garm_why2)
a[,1]
a
b
name(b)
names(b)
b
rownames(b)
rownames(a)
a = select(.data = data, 17,32)
atable<-a %>%
table()
atable
a = select(.data = data, 17,32)
fct_list <- c("資源の浪費や廃棄物の増加等、環境に悪影響を与えるから" = "資源保全","衣服に対する愛着や思い出を粗末にするべきでないから" = "思い出",
"物を大切にした方が経済的で得だから" = "節約", "同じ服は二度と手に入らないかもしれないから" = "希少性", "自分にとっては不用でも他の人は必要と思うかもしれないから"="他人のオプション","わからない"="わからない", "不用な衣服は大切に扱うべきだと思わない"="そう思わない" )
a <- a %>% mutate(x = fct_recode(x, !!!fct_list))
a <- a %>% mutate(x = fct_recode(garm_why1, !!!fct_list))
a
fct_list <- c("資源保全" = "資源の浪費や廃棄物の増加等、環境に悪影響を与えるから","衣服に対する愛着や思い出を粗末にするべきでないから" = "思い出",
"物を大切にした方が経済的で得だから" = "節約", "同じ服は二度と手に入らないかもしれないから" = "希少性", "自分にとっては不用でも他の人は必要と思うかもしれないから"="他人のオプション","わからない"="わからない", "不用な衣服は大切に扱うべきだと思わない"="そう思わない" )
a <- a %>% mutate(x = fct_recode(garm_why1, !!!fct_list))
a
fct_list <- c("資源保全" = "資源の浪費や廃棄物の増加等、環境に悪影響を与えるから","思い出" = "衣服に対する愛着や思い出を粗末にするべきでないから",
"節約" = "物を大切にした方が経済的で得だから", "希少性" = "同じ服は二度と手に入らないかもしれないから", "他人のオプション"="自分にとっては不用でも他の人は必要と思うかもしれないから","わからない"="わからない", "そう思わない"="不用な衣服は大切に扱うべきだと思わない" )
a <- a %>% mutate(x = fct_recode(garm_why1, !!!fct_list))
a
a <- a %>% mutate(garm_why1 = fct_recode(garm_why1, !!!fct_list))
a
a
a <- a %>% mutate(garm_why1 = fct_recode(garm_why1, !!!fct_list))
a
a <- a %>% mutate(garm_why1 = fct_recode(garm_why1, !!!fct_list),garm_why2 = fct_recode(garm_why2, !!!fct_list))
a
table(a)
#データ等下準備
data<-read.csv("BAZAAR.csv",header=TRUE)
library(tidyverse)
a = select(.data = data, 17,32)
table(data$garm_why1)
fct_list <- c("資源保全" = "資源の浪費や廃棄物の増加等、環境に悪影響を与えるから","思い出" = "衣服に対する愛着や思い出を粗末にするべきでないから",
"節約" = "物を大切にした方が経済的で得だから", "希少性" = "同じ服は二度と手に入らないかもしれないから", "他人のオプション"="自分にとっては不用でも他の人は必要と思うかもしれないから","わからない"="わからない", "そう思わない"="不用な衣服は大切に扱うべきだと思わない" )
a <- a %>% mutate(garm_why1 = fct_recode(garm_why1, !!!fct_list),garm_why2 = fct_recode(garm_why2, !!!fct_list))
table(data$garm_why1)
table(data$garm_why1)
before<-table(data$garm_why1)
after<-table(data$garm_why2)
before[,1]
before[1,]
class(before)
as.data.frame(before)
as.data.frame(after)
before_df<-as.data.frame(before)
after_df<-as.data.frame(after)
before_df
before_df[2,]
before_df
after_df
before_df
add_name<-c("不用な衣服は大切に扱うべきだと思わない","物を大切にした方が経済的で得だから")
add_data<-c(0,0)
add_dataframe<-data.frame(add_name,add_data)
add_dataframe
add_df<-data.frame(add_name,add_data)
rbind(after_df,add_df)
after_df
add_df
colnames(add_df)
after_df
Var1<-c("不用な衣服は大切に扱うべきだと思わない","物を大切にした方が経済的で得だから")
Freq<-c(0,0)
add_df<-data.frame(Var1,Freq)
rbind(after_df,add_df)
cbind(before_df,after_df)
cbind(before_df,after_df[,2])
cbind(before_df,after_df[,2])
cbind(before_df,after_df)
add_df<-data.frame(Var1,Freq)
Var1<-c("不用な衣服は大切に扱うべきだと思わない","物を大切にした方が経済的で得だから")
Freq<-c(0,0)
add_df<-data.frame(Var1,Freq)
add_df
rbind(after_df,add_df)
after_df2<-rbind(after_df,add_df)
cbind(before_df,after_df2)
after_df2
before_df
after_df3<-rbind(add_df2,after_df)
Var1<-c("無回答")
Freq<-c(0)
add_df2<-data.frame(Va1,Freq)
add_df2<-data.frame(Var1,Freq)
after_df3<-rbind(add_df2,after_df)
after_df3
after_df3<-rbind(add_df2,after_df2)
after_df3
rownames(before_df)
before_df
before_df[1,1]
before_df[1,1]
before_df
before_df[1,]
before_df[2,]
before_df[1,]
before_df[1,2]
before_df[1,3]
before_df[1,1]
before_df
#データ等下準備
data<-read.csv("BAZAAR.csv",header=TRUE)
library(tidyverse)
before<-table(data$garm_why1)
before_df<-as.data.frame(before)
cbind(before_df,after_df2)
before_df
after_df3<-rbind(after_df2,add_df2)
cbind(before_df,after_df2)
before_df
after_df2
after_df3<-rbind(after_df2,add_df2)
cbind(before_df,after_df2)
cbind(before_df,after_df3)
df<-cbind(before_df,after_df3)
df[,3]
df
df[,3]
df[,!3]
df[,-3]
df<-df[,-3]
df
rownames(df)
df
df<-df[-1,-3]
df
df<-cbind(before_df,after_df3)
df<-df[-1,-3]
df
df<-cbind(before_df,after_df3)
df<-df[,-3]
df
df<-df[,-1]
df
rownames(df)
rownames(df)<-mynames_c
mynames_c<-c("思い出","資源保全","他人のオプション","大切にしなくていい","節約","無回答")
rownames(df)<-mynames_c
df
mynames_r<-c("before","after")
mynames_<-c("思い出","資源保全","他人のオプション","大切にしなくていい","節約","無回答")
rownames(df)<-mynames_r
rownames(df)<-mynames_c
mynames_r<-c("思い出","資源保全","他人のオプション","大切にしなくていい","節約","無回答")
rownames(df)<-mynames_r
colnames(df)<-mynames_c
df
colnames(df)
mynames_c<-c("before","after")
colnames(df)<-mynames_c
df
fisher.test(df)
# 比率（縦％）を確認
round(t(t(df) / colSums(df)) * 100, 1)
# カイ二乗検定
RES <- chisq.test(X)
# カイ二乗検定
RES <- chisq.test(df)
RES
# 調整残差
RES$stdres
# 残差分析のｐ値を算出
p.value.matrix <- pnorm(abs(RES$stdres), lower.tail=FALSE)*2
p.value.matrix
Dim <- dim(df)
p.value.matrix.holm <- matrix(p.adjust(p.value.matrix), Dim[1], Dim[2])
dimnames(p.value.matrix.holm) <- dimnames(df)
round(p.value.matrix.holm, 4)
before<-table(data$roomshare1)
after<-table(data$roomshare2)
before_df<-as.data.frame(before)
after_df<-as.data.frame(after)
before_df
table(data$roomshare1)
after<-table(data$roomshare2)
before_df<-as.data.frame(before)
before_df
after_df<-as.data.frame(after)
after_df
before_df
Var1<-c("どうして手放すのに抵抗があるのかその同居者が気付けるように、一緒に話し合ったり、ルームシェアをしていくうえで問題となることを伝え、どうすべきかをみんなで一緒に考える。")
Freq<-c(0,)
Freq<-c(0)
add_df<-data.frame(Var1,Freq)
after_df2<-rbind(after_df,add_df)
after_df2
before_df
after_df3<-after_df2[,c(1,3,4,5,6,2)]
after_df2<-rbind(after_df,add_df)
after_df3<-after_df2[,c(1,3,4,5,6,2)]
after_df2
after_df2[,2]
after_df3<-after_df2[c(1,3,4,5,6,2),]
after_df3
after_df2[c(1,3,4,5,6,2),]
after_df2
after_df2[1,]
after_df2[,3]
after_df2[3,]
after_df2[4,]
after_df2
after_df2[c(1,3,4,5,6,2),]
after_df2
after_df2[1,]
after_df2[2,]
after_df2
after_df2[c(1,3,4,5,6,2),]
after_df3<-after_df2[c(1,6,2,3,4,5),]
after_df3
df<-cbind(before_df,after_df3)
df
df<-df[,-3]
df<-df[,-1]
mynames_r<-c("解消","話し合う","手放す","考える","多数決","待つ")
rownames(df)<-mynames_r
mynames_c<-c("before","after")
colnames(df)<-mynames_c
df
fisher.test(df)
# 比率（縦％）を確認
round(t(t(df) / colSums(df)) * 100, 1)
# カイ二乗検定
RES <- chisq.test(df)
# 調整残差
RES$stdres
# 残差分析のｐ値を算出
p.value.matrix <- pnorm(abs(RES$stdres), lower.tail=FALSE)*2
round(p.value.matrix, 4)
# ホルムの方法による有意水準の調整（多重比較）
Dim <- dim(df)
p.value.matrix.holm <- matrix(p.adjust(p.value.matrix), Dim[1], Dim[2])
dimnames(p.value.matrix.holm) <- dimnames(df)
round(p.value.matrix.holm, 4)
before<-table(data$minakawa1)
after<-table(data$minakawa2)
before_df<-as.data.frame(before)
after_df<-as.data.frame(after)
before_df
after_df
df<-cbind(before_df,after_df)
df
df<-df[,-3]
df<-df[,-1]
mynames_r<-c("有効活用","思い出づくり","良い物を買う","不便を楽しむ")
rownames(df)<-mynames_r
mynames_c<-c("before","after")
colnames(df)<-mynames_c
df
before<-table(data$minakawa1)
after<-table(data$minakawa2)
before_df<-as.data.frame(before)
after_df<-as.data.frame(after)
df<-cbind(before_df,after_df)
df
df<-df[,-3]
df<-df[,-1]
mynames_r<-c("思い出づくり","有効活用","良い物を買う","不便を楽しむ")
rownames(df)<-mynames_r
mynames_c<-c("before","after")
colnames(df)<-mynames_c
df
fisher.test(df)
# 比率（縦％）を確認
round(t(t(df) / colSums(df)) * 100, 1)
# カイ二乗検定
RES <- chisq.test(df)
# 調整残差
RES$stdres
# 残差分析のｐ値を算出
p.value.matrix <- pnorm(abs(RES$stdres), lower.tail=FALSE)*2
round(p.value.matrix, 4)
# ホルムの方法による有意水準の調整（多重比較）
Dim <- dim(df)
p.value.matrix.holm <- matrix(p.adjust(p.value.matrix), Dim[1], Dim[2])
dimnames(p.value.matrix.holm) <- dimnames(df)
round(p.value.matrix.holm, 4)
